<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>UDGAMES Dashboard</title>

  <link rel="stylesheet" href="style.css" />

  <script defer src="src/components/searchbar.js"></script>
  <script defer src="src/components/scrollbar.js"></script>
  <script defer src="src/router.js"></script>
</head>

<body>

  <nav class="navbar">
    <img src="src/assets/images/UD-GAMES.png" class="logo" alt="UDGAMES logo" />

    <div class="nav-center" aria-hidden="true">
      <div class="page-name" id="nav-page-name">UDGAMES</div>
      <div class="page-sub" id="nav-page-sub">Development Dashboard</div>
    </div>

    <div id="top-search"></div>
  </nav>

  <div class="site-grid">

    <aside class="sidebar" role="navigation">
      <h3>Navigation</h3>
      <a href="#home" data-route="home">Home</a>
      <a href="#docs" data-route="docs">Docs</a>
      <a href="#forum" data-route="forum">Forum</a>
      <a href="#game" data-route="game">Game</a>
      <a href="#gameupdate" data-route="gameupdate">Updates</a>
      <a href="#hire" data-route="hire">Hire</a>
      <a href="#toggle" data-route="toggle">Toggle</a>
    </aside>

    <main class="main">
      <div id="app"></div>
    </main>

    <!-- Team Members Panel -->
    <aside class="rightcol" id="team-panel"></aside>

  </div>

  <script>
    const PAGE_META = {
      home: { title: "Home", sub: "Welcome to UDGAMES" },
      docs: { title: "Docs", sub: "Guides & Info" },
      forum: { title: "Forum", sub: "Community" },
      game: { title: "Game", sub: "Game Info" },
      gameupdate: { title: "Updates", sub: "Recent Updates" },
      hire: { title: "Hire", sub: "Work With Us" },
      toggle: { title: "Toggle", sub: "Settings" }
    };

    function updateNavCenter() {
      const hash = location.hash.replace('#','') || 'home';
      const meta = PAGE_META[hash] || { title: "UDGAMES", sub: "Dashboard" };
      document.getElementById('nav-page-name').textContent = meta.title;
      document.getElementById('nav-page-sub').textContent = meta.sub;

      document.querySelectorAll('.sidebar a').forEach(a => {
        a.classList.toggle('active', a.getAttribute('data-route') === hash);
      });
    }

    window.addEventListener('hashchange', updateNavCenter, {passive:true});
    window.addEventListener('load', updateNavCenter, {passive:true});

    // Load Team Members into Right Panel
    async function loadTeamPanel() {
      const GROUP_ID = 35398646;
      const panel = document.getElementById("team-panel");
      panel.innerHTML = "<h3>Team Members</h3><div class='team-list'>Loadingâ€¦</div>";

      try {
        const res = await fetch(
          `https://groups.roblox.com/v1/groups/${GROUP_ID}/users?limit=100`
        );
        const data = await res.json();

        const listDiv = document.createElement("div");
        listDiv.className = "team-list";

        for (const member of data.data) {
          const id = member.user.userId;
          const username = member.user.username;
          const img = `https://www.roblox.com/headshot-thumbnail/image?userId=${id}&width=100&height=100&format=png`;

          const item = document.createElement("div");
          item.className = "team-member";
          item.innerHTML = `
            <img src="${img}" alt="${username}">
            <span>${username}</span>
          `;
          listDiv.appendChild(item);
        }

        panel.innerHTML = "<h3>Team Members</h3>";
        panel.appendChild(listDiv);

      } catch (e) {
        panel.innerHTML = "<h3>Team Members</h3>Error loading members.";
        console.error(e);
      }
    }

    window.addEventListener("load", loadTeamPanel);
  </script>

</body>
</html>
