<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>UDGAMES Dashboard</title>

  <link rel="stylesheet" href="style.css" />

  <script defer src="src/components/searchbar.js"></script>
  <script defer src="src/components/scrollbar.js"></script>
  <script defer src="src/router.js"></script>
</head>

<body>

  <nav class="navbar">
    <img src="src/assets/images/UD-GAMES.png" class="logo" alt="UDGAMES" />

    <div class="nav-center">
      <div class="page-name" id="nav-page-name">UDGAMES</div>
      <div class="page-sub" id="nav-page-sub">Development Dashboard</div>
    </div>

  <div id="top-search"></div>
  </nav>

  <!-- layout-grid → site-grid -->
  <div class="site-grid">

    <aside class="sidebar">
      <h3>Navigation</h3>
      <a href="#home" data-route="home">Home</a>
      <a href="#docs" data-route="docs">Docs</a>
      <a href="#forum" data-route="forum">Forum</a>
      <a href="#game" data-route="game">Game</a>
      <a href="#gameupdate" data-route="gameupdate">Updates</a>
      <a href="#hire" data-route="hire">Hire</a>
      <a href="#toggle" data-route="toggle">Toggle</a>
    </aside>

    <!-- main-area → main -->
    <main class="main">
      <div id="app"></div>
    </main>

    <!-- team-panel class → rightcol (ID stays same) -->
    <aside class="rightcol" id="team-panel">
      <h3>Team Members</h3>
      <div class="team-list">Loading…</div>
    </aside>

  </div>

  <script>
    const PAGE_META = {
      home: { title: "Home", sub: "Welcome" },
      docs: { title: "Docs", sub: "Information" },
      forum: { title: "Forum", sub: "Community" },
      game: { title: "Game", sub: "Game Info" },
      gameupdate: { title: "Updates", sub: "Changes" },
      hire: { title: "Hire", sub: "Jobs" },
      toggle: { title: "Toggle", sub: "Settings" }
    };

    function updateNavCenter() {
      const hash = location.hash.replace('#', '') || 'home';
      const meta = PAGE_META[hash] || { title: "UDGAMES", sub: "" };
      document.getElementById('nav-page-name').textContent = meta.title;
      document.getElementById('nav-page-sub').textContent = meta.sub;

      document.querySelectorAll('.sidebar a').forEach(a => {
        a.classList.toggle('active', a.getAttribute('data-route') === hash);
      });
    }

    window.addEventListener('hashchange', updateNavCenter);
    window.addEventListener('load', updateNavCenter);

    async function loadTeamPanel() {
      const GROUP_ID = 35398646;
      const listDiv = document.querySelector("#team-panel .team-list");

      try {
        const res = await fetch(`https://groups.roblox.com/v1/groups/${GROUP_ID}/users?limit=100`);
        const data = await res.json();
        listDiv.innerHTML = "";

        data.data.forEach(member => {
          const id = member.user.userId;
          const username = member.user.username;

          const item = document.createElement("div");
          item.className = "team-member";
          item.innerHTML = `
            <img src="https://www.roblox.com/headshot-thumbnail/image?userId=${id}&width=100&height=100&format=png">
            <span>${username}</span>
          `;

          listDiv.appendChild(item);
        });

      } catch (err) {
        listDiv.textContent = "Failed to load.";
      }
    }

    window.addEventListener("load", loadTeamPanel);
  </script>

</body>
</html>
